self.sqliteWorker=function(e){"use strict";const t=["name","type","notnull","dflt_value","pk"],{keys:n}=Object,r=(e,t,r)=>new Promise(((i,u)=>{const m=o(t),f=n(r);e.all(`PRAGMA table_info('${m}')`,((t,n)=>{const{length:h}=n,p=f.map(c,r),d=`tmp_${m}_backup`,E=`CREATE TABLE IF NOT EXISTS '${h?d:m}' (${s(p)})`;h?e.run(E,(t=>{t?u(t):e.all(`PRAGMA table_info('${d}')`,((t,r)=>{if(n.length!==r.length||n.some(a,r)){const t=n.filter(l,r).map((e=>`'${o(e.name)}'`)),c=t.map((e=>`'${m}'.${e}`));e.run(`INSERT INTO '${d}' (${s(t)})\n                      SELECT ${s(c)} FROM '${m}'`,(t=>{t?e.run(`DROP TABLE IF EXISTS '${d}'`,(()=>u(t))):e.run(`DROP TABLE IF EXISTS '${m}'`,(()=>{e.run(`ALTER TABLE '${d}' RENAME TO '${m}'`,i)}))}))}else e.run(`DROP TABLE IF EXISTS '${d}'`,i)}))})):e.run(E,(e=>{e?u(e):i()}))}))})),o=e=>e.replace(/'/g,"''"),s=e=>e.join(", ");function l(e){return-1<this.findIndex((({name:t})=>t===e.name))}function c(e){return`'${o(e)}' ${this[e]}`}function a(e,n){const r=this[n];return t.some((t=>e[t]!==r[t]))}const i=(e,t)=>e(t).then((e=>t.tables?((e,t)=>new Promise(((o,s)=>{const l=[];for(const o of n(t))l.push(r(e,o,t[o]));Promise.all(l).then(o,s)})))((({all:e,query:t})=>({all(t,n){e([t]).then((e=>n(null,e)),n)},run(e,n){t([e]).then((()=>n()),n)}}))(e),t.tables).then((()=>e)):e));const u=new WeakMap,m=(e,t)=>{const n=[e[0]],r=[];for(let o=0,s=0,l=0,{length:c}=t;s<c;s++)t[s]instanceof f?n[o]+=t[s].v+e[s+1]:(r[l++]=s,n[++o]=e[s+1]);return{t:n,v:r}};function f(e){this.v=e}const{defineProperty:h}=Object,p=(e,t)=>(n,...r)=>new Promise(((o,s)=>{if(n.some((e=>e.includes("?")))){const e=new Error("SQLITE_ERROR: SQL injection hazard");e.code="SQLITE_ERROR",s(e)}else{const[l,...c]=((e,...t)=>{const{t:n,v:r}=m(e,t),o=u.get(e)||u.set(e,{}).get(e);return(o[n]||(o[n]=[n])).concat(r.map((e=>t[e])))})(n,...r);e[t](l.join("?"),c,((e,t)=>{e?s(e):o(t)}))}}));function d(e){const t=p(e,"run");return{transaction(){let e=t(["BEGIN TRANSACTION"]);return h(((...n)=>{e=e.then((()=>t(...n)))}),"commit",{value:()=>e=e.then((()=>t(["COMMIT"])))})},all:p(e,"all"),get:p(e,"get"),raw:(e,...t)=>{return n=function(e){for(var t=e[0],n=1,r=arguments.length;n<r;n++)t+=arguments[n]+e[n];return t}(e,...t),new f(n);var n},query:t}}const{assign:E}=Object,T="function"==typeof importScripts,g=t=>new Promise(((n,r)=>{const o=()=>{const e=self.module.exports;delete self.exports,self.module=void 0,n(e)};if(self.exports={},self.module={exports:e},T)importScripts(t),o();else{const{head:e}=document;E(e.appendChild(document.createElement("script")),{onload(){e.removeChild(this),o()},onerror:r,src:t})}})),I="sqlite",S="buffer",$=(e,t=1)=>new Promise(((n,r)=>{E(indexedDB.open(e,t),{onupgradeneeded({target:{result:e,transaction:t}}){e.objectStoreNames.contains(I)||e.createObjectStore(I).createIndex(S,S,{unique:!0}),E(t,{oncomplete(){n(e)}})},onsuccess({target:{result:e}}){n(e)},onerror:r})})),w=(e={})=>new Promise(((t,n)=>{const r=e.dist||".";g(r+"/sql-wasm.js").then((({default:o})=>{Promise.all([$(e.name||"sqlite-worker"),o({locateFile:e=>r+"/"+e})]).then((([r,{Database:o}])=>{const s=e=>r.transaction([I],e).objectStore(I);E(s("readonly").get(S),{onsuccess(){let n=Promise.resolve();const{result:r}=this,l=new o(r||e.database||new Uint8Array(0)),c=()=>{n=n.then((()=>new Promise(((t,n)=>{const r=l.export();E(s("readwrite").put(r,S).transaction,{oncomplete(){t(),e.update&&e.update(r)},onabort:n,onerror:n})}))))};r||c();const{all:a,get:i,query:u,raw:m,transaction:f}=d({all(e,t,n){try{const r=l.exec(e,t),o=[];r.forEach(R,o),n(null,o)}catch(e){n(e)}},get(e,t,n){try{const r=l.exec(e+" LIMIT 1",t),o=[];r.forEach(R,o),n(null,o.shift()||null)}catch(e){n(e)}},run(e,t,n){try{n(null,l.run(e,t))}catch(e){n(e)}}});let h=0;t({all:a,get:i,raw:m,transaction:f,query(t){return/\b(?:INSERT|DELETE|UPDATE)\b/i.test(t[0])&&(clearTimeout(h),h=setTimeout(c,e.timeout||250)),u.apply(this,arguments)}})},onerror:n})}),n)}))}));function R({columns:e,values:t}){for(let{length:n}=t,r=0;r<n;r++){const n=t[r],o={};for(let{length:t}=e,r=0;r<t;r++)o[e[r]]=n[r];this.push(o)}}return(e={})=>i(w,e)}({});